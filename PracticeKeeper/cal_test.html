<!DOCTYPE html>
<html>

<head>
  <title>cal test</title>

  <script type="text/javascript" src="color.js">    </script>
  <script type="text/javascript" src="lib/color-scheme.js">     </script>
  <script type="text/javascript" src="lib/jscolor.js">          </script>

  <!-- custom javascript files -->
  <script type="text/javascript" src="calendar.js"> </script>
  <script type="text/javascript" src="color.js">    </script>
  <script type="text/javascript" src="main.js">     </script>

  <!--csv file converted to json file using online converter -->
  <script type="text/javascript" src="data.json">   </script>



  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>

  <!-- Bootstrap 4 requires Popper.js -->
  <script src="https://unpkg.com/popper.js@1.14.1/dist/umd/popper.min.js" crossorigin="anonymous"></script>

  <!-- Boostrap 4 -->
  <link href="flat-ui/css/vendor/bootstrap.min.css" rel="stylesheet">

  <!-- Loading Flat UI -->
  <link href="flat-ui/css/flat-ui.css" rel="stylesheet">
  <script src="flat-ui/scripts/flat-ui.js"></script>

  <link rel="stylesheet" type="text/css" href="cal_test.css" />

  <link rel="stylesheet" type="text/css" href="year-cal/css/bootstrap-year-calendar.css" />
  <script type="text/javascript" src="year-cal/js/bootstrap-year-calendar.js"> </script>
  <link rel="stylesheet" type="text/css" href="cal_test.css" />


</head>

<body>
  <div>
    <iframe name="frame" style="display:none;"></iframe>
    <form action="about:blank" method="post" target="frame">
      <div class="col-lg-2">
        <div class="form-group">
          <input type="text" class="form-control jscolor" id="color" value="FF934B">
            <button type="submit" class="btn btn-primary btn-lg"  value="meow" onclick="refresh_cal()">
                Change Calendar Color
            </button>
        </div>
      </div>
    </form>
  </div>
  <div class ="my-div">
    <div class="calendar" id="calendar"></div>
  </div>

    <div class="wrapper"></div>

<script>
function refresh_cal(){
  document.getElementById("calendar").remove();
  $('.my-div').append('<div class="calendar" id="calendar"></div>');
  var color = $("#color").val();
  var colors = generateColor(color,"FFFFFF",max_per_day); //for fade from nothing make second argument white (FFFFFF)
    var cond_array=[];
    var heat_mapped_color_array=[];

    for(var i=0;i<my_cal.day_array.length;i++){
      var current_day_mins = my_cal.day_array[i].total_practice_time_min;
      var currentYear = my_cal.day_array[i].currentDay.getFullYear();
      var currentMonth = my_cal.day_array[i].currentDay.getMonth();
      var currentDay = my_cal.day_array[i].currentDay.getDate();

      var condition = new Date(currentYear,currentMonth,currentDay).getTime();
      cond_array.push(condition);
      var heat_mapped_color =colors[current_day_mins];
      heat_mapped_color_array.push(heat_mapped_color)
    }
  $('#calendar').calendar({
    minDate: new Date(myStartDate),
    maxDate: new Date(myEndDate),
    customDayRenderer: function(element, date) {
      for(var i=0;i<cond_array.length;i++){
          if(date.getTime()==cond_array[i]){
            $(element).css('background-color', heat_mapped_color_array[i]);
            $(element).css('border-radius', '15px');
          }
        }
    },
  });

}

</script>




<script>
  var my_cal = load_data();
  var max_per_day = my_cal.maxTimeInDay()+1;
  // console.log(max_per_day);
  var colors = generateColor("96F2FF","FFFFFF",max_per_day); //for fade from nothing make second argument white (FFFFFF)
  // console.log(colors);

  for(var i=0;i<my_cal.day_array.length;i++){
    var current_day_mins = my_cal.day_array[i].total_practice_time_min;
    // console.log("color for");
    // console.log(my_cal.day_array[i].short_print());
    // console.log("is");
    // console.log(colors[current_day_mins]);
  }
  for (var i = 0; i < 88; i++) { //testing the gradient
		// $('.wrapper').append('<div id="rect' + i + '" class="rectangle"><br> </div>');
    // var current_day_mins = my_cal.day_array[i].total_practice_time_min;
    // document.getElementById("rect"+i).style.backgroundColor = colors[current_day_mins];
	}

  var myStartYear =    my_cal.day_array[0].currentDay.getFullYear();
  var myStartMonth = my_cal.day_array[0].currentDay.getMonth();
  var myStartDay = my_cal.day_array[0].currentDay.getDate();
  var myStartDate = new Date(myStartYear, myStartMonth, myStartDay);

  var myEndYear =    my_cal.day_array[my_cal.day_array.length-1].currentDay.getFullYear();
  var myEndMonth = my_cal.day_array[my_cal.day_array.length-1].currentDay.getMonth();
  var myEndDay = my_cal.day_array[my_cal.day_array.length-1].currentDay.getDate();
  var myEndDate = new Date(myEndYear, myEndMonth, myEndDay);

  var cond_array=[];
  var heat_mapped_color_array=[];

  for(var i=0;i<my_cal.day_array.length;i++){
    var current_day_mins = my_cal.day_array[i].total_practice_time_min;
    var currentYear = my_cal.day_array[i].currentDay.getFullYear();
    var currentMonth = my_cal.day_array[i].currentDay.getMonth();
    var currentDay = my_cal.day_array[i].currentDay.getDate();

    var condition = new Date(currentYear,currentMonth,currentDay).getTime();
    cond_array.push(condition);
    var heat_mapped_color =colors[current_day_mins];
    heat_mapped_color_array.push(heat_mapped_color)
  }
  // setting up calendar
  $(function() {
    $('#calendar').calendar({
      minDate: new Date(myStartDate),
      maxDate: new Date(myEndDate),
      customDayRenderer: function(element, date) {
        for(var i=0;i<cond_array.length;i++){
            if(date.getTime()==cond_array[i]){
              $(element).css('background-color', heat_mapped_color_array[i]);
              $(element).css('border-radius', '15px');
            }
          }
      },
    });
  });

</script>


</body>
</html>

<!DOCTYPE html>
<html>

<head>
  <title>PracticeKeeper Charts</title>

  <!--libraries and dependencies-->
  <script src="lib/chart.bundle.min.js"> </script>
  <script src="lib/color-scheme.js">     </script>
  <script src="lib/jscolor.js">          </script>

  <!--csv file converted to json file using online converter -->
  <script type="text/javascript" src="js/data.json">   </script>


  <!-- Dependencies For Flat UI -->
  <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
  <script src="https://unpkg.com/popper.js@1.14.1/dist/umd/popper.min.js" crossorigin="anonymous"></script>
  <link href="lib/flat-ui/css/vendor/bootstrap.min.css" rel="stylesheet">

  <!--Flat UI -->
  <link href="lib/flat-ui/css/flat-ui.css" rel="stylesheet">
  <script src="lib/flat-ui/scripts/flat-ui.js"></script>

  <!-- Custom js and css files -->
  <script src="js/calendar.js"> </script>
  <script src="js/color.js">    </script>
  <script src="js/main.js">     </script>
  <link rel="stylesheet" type="text/css" href="css/chart.css" />

</head>

<body>
  <div id="TopHalf">

    <a href="./home.html">Home</a>
    <p>
    <b>Graphs</b> <!--current page-->
    <p>
    <a href="./about.html">About</a>

    <iframe name="frame" style="display:none;"></iframe>

    <form action="about:blank" method="post" target="frame">
      <input name="color1" class="jscolor" id="color2" value="FF934B">
      <input name="color2" class="jscolor" id="color1" value="FF5BDB">
      <button type="submit" class="btn btn-primary btn-lg"  value="Refresh Graphs" onclick="redraw_charts()">
          Refresh Graphs
      </button>

    </form>


    <div id="bar-chart">
      <canvas id="bar-graph" width="800" height="450"></canvas>
    </div>

  </div>

  <div id="BottomHalf">
    <div id="doughnut-graph">
      <canvas id="doughnut-chart" width="800" height="450"></canvas>
    </div>
  </div>

  <script>
  Chart.defaults.global.defaultFontColor = 'black';

    //create first bar graph and doughnut graphs
    var grad_start       = $("#color1").val();
    var grad_end         = $("#color2").val();
    var chart_data       = load_data();
    var bar_chart_data   = make_bar_data(chart_data);
    var bar_graph_labels = make_data_labels(chart_data);
    var colors           = generateColor(grad_start,grad_end,chart_data.length);
    var title            = chart_data.print_bar_title();
    var bar_ctx          = document.getElementById("bar-graph").getContext('2d');
    var bar_config       = {
        type: 'bar',
        data:{
          labels: bar_graph_labels,
          datasets:[{
            data:bar_chart_data,
            backgroundColor: colors
          }]
        },
        options: {
          legend:{
            display:false,
          },
          responsive: true,
          maintainAspectRatio: false,
          title:{
            display: true,
            text:title,
            fontColor:"black"
          }
        }
      }

    var pie_chart_data  = pie_chart_data_of(chart_data);
    var doughnut_colors = generateColor(grad_start,grad_end,pie_chart_data.length);
    var doughnut_ctx    = document.getElementById("doughnut-chart").getContext('2d');
    var doughnut_config = {
        type: 'doughnut',
        data: {
          labels: practice_types,
          datasets: [
            {
              backgroundColor: doughnut_colors,
              data: pie_chart_data
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false
        }
    }
    //create
    var my_doughnut = new Chart(doughnut_ctx, doughnut_config);
    var my_bar      = new Chart(bar_ctx, bar_config);


    function redraw_charts(){
      my_bar.destroy();
      my_doughnut.destroy();
      var updated_grad_start = $("#color1").val();
      var updated_grad_end   = $("#color2").val();
      var bar_chart_data     = make_bar_data(chart_data);
      var bar_graph_labels   = make_data_labels(chart_data);
      var bar_colors         = generateColor(updated_grad_start,updated_grad_end,chart_data.length);
      var title              = chart_data.print_bar_title();
      var bar_ctx            = document.getElementById("bar-graph").getContext('2d');
      var bar_config = {
          type: 'bar',
          data:{
            labels: bar_graph_labels,
            datasets:[{
              data:bar_chart_data,
              backgroundColor: bar_colors
            }]
          },
          options: {
            legend:{
              display:false,
            },
            responsive: true,
            maintainAspectRatio: false,
            title:{
              display: true,
              text:title,
              fontColor:"black"
            }
          }
        }

      var pie_chart_data  = pie_chart_data_of(chart_data);
      var doughnut_colors = generateColor(updated_grad_start,updated_grad_end,pie_chart_data.length);
      var doughnut_ctx    = document.getElementById("doughnut-chart").getContext('2d');
      var doughnut_config = {
          type: 'doughnut',
          data: {
            labels: practice_types,
            datasets: [
              {
                backgroundColor: doughnut_colors,
                data: pie_chart_data
              }
            ]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false
          }
      }
      //create the new graphs
      my_bar      = new Chart(bar_ctx, bar_config);
      my_doughnut = new Chart(doughnut_ctx, doughnut_config);

    }

  </script>

  <a href="./cal_test.html">Click to see calendar demo</a>




</body>

</html>
